<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encomendas | Busca</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/cadencomendas.css">
</head>

<body>
    <nav id="menu-h">
        <ul>
            <li>
                <a href="../index.html">
                    Inicio
                </a>
            </li>

            <li><a href="./encomendaBusca.html">Busca</a></li>

            <li><a href="./encomendaCadastro.html">Cadastro</a></li>

            <li><a href="./login.html">Entrar</a></li>
        </ul>
    </nav>

    <div id="cadastro">
        <div class="card">
            <div class="card-header">
                <h2> FAÇA A BUSCA DE SUA ENCOMENDA </h2>
            </div>
            <form method="post" action="cadastrar-bloco.php"></form>

            <label class="ls-label col-md-4">
                <b class="ls-label-text">Bloco</b>
                <div class="ls-custom-select">

                    <select name="cadastrar-bloco" id="bloco">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
            </label>

            <form method="post" action="cadastrar-andar.php"></form>

            <label class="ls-label col-md-2">
                <b class="ls-label-text">Andar</b>
                <div class="ls-custom-select">

                    <select name="cadastrar-andar" id="andar">
                        <option value="1">1ª</option>
                        <option value="2">2ª</option>
                        <option value="3">3ª</option>
                        <option value="4">4ª</option>
                    </select>
                </div>
            </label>

            <form method="post" action="cadastrar-apartamento.php"></form>

            <label class="ls-label col-md-2">
                <b class="ls-label-text">Apartamento</b>
                <div class="ls-custom-select">
                    <select name="cadastrar-apartamento" id="apartamento">
                        <option value="101">101</option>
                        <option value="102">102</option>
                        <option value="103">103</option>
                        <option value="104">104</option>

                        <option value="201">201</option>
                        <option value="202">202</option>
                        <option value="203">203</option>
                        <option value="204">204</option>

                        <option value="301">301</option>
                        <option value="302">302</option>
                        <option value="303">303</option>
                        <option value="304">304</option>

                        <option value="401">401</option>
                        <option value="402">402</option>
                        <option value="403">403</option>
                        <option value="404">404</option>

                    </select>
                </div>
            </label>
            <div id="divBusca">
                <button type="button" id="btnBusca" onclick="buscar(event)">Buscar</button>
            </div>

            <div class='text'>
                <p>Bloco: <span class="Bloco"></span></p>
                <p>Andar: <span class="Andar"></span></p>
                <p>Apto: <span class="Apartamento"></span></p>
            </div>
        </div>
    </div>

    <section>
        <div id="tabela-encomendas">
        </div>
    </section>
</body>

</html>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="../js/encomedas.js"></script>

<script>
    async function buscar(event) {

        let numeroBloco = document.querySelector('#bloco').value;
        let numeroAndar = document.querySelector('#andar').value;
        let numeroApartamento = document.querySelector('#apartamento').value;

        if (confirm(`Salvar os dados\n Bloco:${numeroBloco},\n Andar: ${numeroAndar} \n e Apartamento: ${numeroApartamento}`)) {
            event.preventDefault();
            let bloco = document.querySelector('.Bloco');
            let andar = document.querySelector('.Andar');
            let apartamento = document.querySelector('.Apartamento');

            console.log(numeroBloco, numeroAndar, numeroApartamento);

            switch (parseInt(numeroBloco)) {
                case 1:
                    bloco.innerText = "OK";
                    break;
                case 2:
                    bloco.innerText = "OK";
                    break;
                case 3:
                    bloco.innerText = "OK";
                    break;
                case 4:
                    bloco.innerText = "OK";
                    break;
                default:
                    bloco.innerText = "No value found";
            }

            /*switch (parseInt(numeroAndar)) {
                case 1:
                    andar.innerText = "OK";
                    break;
                case 2:
                    andar.innerText = "OK";
                    break;
                case 3:
                    andar.innerText = "OK";
                    break;
                case 4:
                    andar.innerText = "OK";
                    break;
                default:
                    andar.innerText = "No value found";
            }

            switch (parseInt(numeroApartamento)) {
                case 101:
                    apartamento.innerText = "OK";
                    break;
                case 102:
                    apartamento.innerText = "OK";
                    break;
                case 103:
                    apartamento.innerText = "OK";
                    break;
                case 104:
                    apartamento.innerText = "OK";
                    break;
                case 201:
                    apartamento.innerText = "OK";
                    break;
                case 202:
                    apartamento.innerText = "OK";
                    break;
                case 203:
                    apartamento.innerText = "OK";
                    break;
                case 204:
                    apartamento.innerText = "OK";
                    break;
                case 301:
                    apartamento.innerText = "OK";
                    break;
                case 302:
                    apartamento.innerText = "OK";
                    break;
                case 303:
                    apartamento.innerText = "OK";
                    break;
                case 304:
                    apartamento.innerText = "OK";
                    break;
                case 401:
                    apartamento.innerText = "OK";
                    break;
                case 402:
                    apartamento.innerText = "OK";
                    break;
                case 403:
                    apartamento.innerText = "OK";
                    break;
                case 404:
                    apartamento.innerText = "OK";
                    break;
                default:
                    apartamento.innerText = "No value found";

            }*/
        }

        let listaEncomenda = await buscarEncomenda(numeroBloco, numeroAndar, numeroApartamento);
        montarTabela(listaEncomenda);
    }

    function montarTabela(listaEncomenda) {
        let tabelaEncomenda = document.getElementById("tabela-encomendas");
        let tabela = `<p> Quantidade: <b>${listaEncomenda.length}</b> </p>`
        tabela += `<table>`
        tabela += `<tr>`;
        tabela += `<th>Bloco</th>`;
        tabela += `<th>Andar</th>`;
        tabela += `<th>Apartamento</th>`;
        tabela += `<th>Data Entrada</th>`;
        tabela += `<th>Data Saida</th>`;
        tabela += `</tr>`;
        for (encomenda of listaEncomenda) {
            tabela += '<tr>'
            tabela += `<td>${encomenda.bloco}</td>`;
            tabela += `<td>${encomenda.andar}</td>`;
            tabela += `<td>${encomenda.apartamento}</td>`;
            tabela += `<td>${encomenda.data_entrada}</td>`;
            tabela += `<td>${encomenda.data_saida}</td>`;
            tabela += `</tr>`;
        }
        tabela += "</table>";
        tabelaEncomenda.innerHTML = tabela
    }
</script>